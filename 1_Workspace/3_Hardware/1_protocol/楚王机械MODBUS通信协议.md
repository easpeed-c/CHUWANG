# 楚王机械MODBUS通信协议

## 硬件选择
- 定昌3568安卓板
- 7寸标准模组
- 通信接口：RS232

## 软件接口
- 通信协议：RS232 ASCII master,PLC设备作为从机使用
- 通讯数据结构：`9600bps`，`7bit数据`，`Even`，`1起始位`，`1停止位`
- 数据通信格式：`:` `ADR1` `ADR0` `CMD1` `CMD0` `DATA0-DATA(n-1)` `LRC CHK1` `LRC CHK0` `CR` `LF`
  - `:` : 起始字符
  - `ADR1` : 从站地址高码
  - `ADR0` : 从站地址低码
  - `CMD1` : 命令码高码
  - `CMD0` : 命令码低码
  - `DATA` : 要发送的数据
  - `LRC CHK1` : LRC校验高码
  - `LRC CHK0` : LRC校验低码
  - `CR` : 结束字符
  - `LF` : 结束字符
- LRC校验码计算方法：~(`ADR1` + `ADR0` + `CMD1` + `CMD0` + `DATA`)+1

## 使用的软件命令及数据格式
- `CR LF`：使用 `\r\n` 来实现，下述报文描述中将其省略，实际使用需再结尾增加

### 获取实时频率
- 主机发送 `: 01 03 10 02 00 01 E9 CR LF`
  - `:` : 起始字符
  - `01` ：设备地址
  - `03` : 读出寄存器内容值(命令码)
  - __`1002`__：数据地址
  - `0001`：数据长度
  - `E9`：LRC校验码
- 从机响应 `: 01 03 02 dH dL F9`
  - `02` : 数据长度
  - `dH` : 实时频率高字节
  - `dL` : 实时频率低字节

### 发送长度设定参数
- 主机发送 `: 01 06 11 C6 12 34 DC CR LF`
  - `:` : 起始字符
  - `01` ：设备地址
  - `06` : 预设寄存器的值(命令码)
  - __`11C6`__：数据地址
  - `1234`：数据，此处的数据发送键盘实时输入数据
  - `DC`：LRC校验码
- 从机响应 `: 01 06 11 C6 12 34 DC `

### 发送频率设定参数
- 主机发送 `: 01 06 11 AA 12 34 F8 CR LF`
  - `:` : 起始字符
  - `01` ：设备地址
  - `06` : 预设寄存器的值(命令码)
  - __`11AA`__：数据地址
  - `1234`：数据，此处的数据发送键盘实时输入数据
  - `F8`：LRC校验码
- 从机响应 `: 01 06 11 C6 12 34 F8 `

### 发送脉冲系数参数
- 主机发送 `: 01 06 11 CA 12 34 D8 CR LF`
  - `:` : 起始字符
  - `01` ：设备地址
  - `06` : 预设寄存器的值(命令码)
  - __`11CA`__：数据地址
  - `1234`：数据，此处的数据发送键盘实时输入数据
  - `D8`：LRC校验码
- 从机响应 `: 01 06 11 C6 12 34 D8 `

### 发送加减速参数
- 主机发送 `: 01 06 11 A2 12 34 00 CR LF`
  - `:` : 起始字符
  - `01` ：设备地址
  - `06` : 预设寄存器的值(命令码)
  - __`11A2`__：数据地址
  - `1234`：数据，此处的数据发送键盘实时输入数据
  - `00`：LRC校验码
- 从机响应 `: 01 06 11 C6 12 34 00 `
